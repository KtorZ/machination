<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">--  This Source Code Form is subject to the terms of the Mozilla Public</span><span>
</span><span id="line-2"></span><span class="hs-comment">--  License, v. 2.0. If a copy of the MPL was not distributed with this</span><span>
</span><span id="line-3"></span><span class="hs-comment">--  file, You can obtain one at http://mozilla.org/MPL/2.0/.</span><span>
</span><span id="line-4"></span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE DuplicateRecordFields #-}</span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# LANGUAGE NamedFieldPuns #-}</span><span>
</span><span id="line-7"></span><span>
</span><span id="line-8"></span><span class="hs-comment">-- |</span><span>
</span><span id="line-9"></span><span class="hs-comment">-- Copyright: &#169; 2018-2020 IOHK</span><span>
</span><span id="line-10"></span><span class="hs-comment">-- License: MPL-2.0</span><span>
</span><span id="line-11"></span><span class="hs-comment">-- Stability: experimental</span><span>
</span><span id="line-12"></span><span class="hs-comment">--</span><span>
</span><span id="line-13"></span><span class="hs-comment">-- Plot 'Histogram' as unicode strings; for terminal plotting.</span><span>
</span><span id="line-14"></span><span class="hs-comment">-- For example, one could plot answers and their frequencies to the question:</span><span>
</span><span id="line-15"></span><span class="hs-comment">--</span><span>
</span><span id="line-16"></span><span class="hs-comment">-- /&quot;Who's your favorite metal band?&quot;/</span><span>
</span><span id="line-17"></span><span class="hs-comment">--</span><span>
</span><span id="line-18"></span><span class="hs-comment">-- &gt; plot $ Histogram</span><span>
</span><span id="line-19"></span><span class="hs-comment">-- &gt;     { width  = 80</span><span>
</span><span id="line-20"></span><span class="hs-comment">-- &gt;     , height = 24</span><span>
</span><span id="line-21"></span><span class="hs-comment">-- &gt;     , bins   =</span><span>
</span><span id="line-22"></span><span class="hs-comment">-- &gt;         [ ( &quot;Metallica&quot;, 78 )</span><span>
</span><span id="line-23"></span><span class="hs-comment">-- &gt;         , ( &quot;Iron Maiden&quot;, 61 )</span><span>
</span><span id="line-24"></span><span class="hs-comment">-- &gt;         , ( &quot;Slayer&quot;, 16 )</span><span>
</span><span id="line-25"></span><span class="hs-comment">-- &gt;         , ( &quot;Dimmu Borgir&quot;, 3 )</span><span>
</span><span id="line-26"></span><span class="hs-comment">-- &gt;         , ( &quot;Ghost&quot;, 48 )</span><span>
</span><span id="line-27"></span><span class="hs-comment">-- &gt;         ]</span><span>
</span><span id="line-28"></span><span class="hs-comment">-- &gt;     }</span><span>
</span><span id="line-29"></span><span class="hs-comment">--</span><span>
</span><span id="line-30"></span><span class="hs-comment">-- &gt; 78 &#9508;&#9484;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9488;</span><span>
</span><span id="line-31"></span><span class="hs-comment">-- &gt;    &#9474;&#9474;             &#9474;</span><span>
</span><span id="line-32"></span><span class="hs-comment">-- &gt;    &#9474;&#9474;             &#9474;</span><span>
</span><span id="line-33"></span><span class="hs-comment">-- &gt;    &#9474;&#9474;             &#9474;</span><span>
</span><span id="line-34"></span><span class="hs-comment">-- &gt;    &#9474;&#9474;             &#9474;</span><span>
</span><span id="line-35"></span><span class="hs-comment">-- &gt; 62 &#9508;&#9474;             &#9474;</span><span>
</span><span id="line-36"></span><span class="hs-comment">-- &gt;    &#9474;&#9474;             &#9500;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9488;</span><span>
</span><span id="line-37"></span><span class="hs-comment">-- &gt;    &#9474;&#9474;             &#9474;             &#9474;</span><span>
</span><span id="line-38"></span><span class="hs-comment">-- &gt;    &#9474;&#9474;             &#9474;             &#9474;</span><span>
</span><span id="line-39"></span><span class="hs-comment">-- &gt;    &#9474;&#9474;             &#9474;             &#9474;</span><span>
</span><span id="line-40"></span><span class="hs-comment">-- &gt; 47 &#9508;&#9474;             &#9474;             &#9474;                           &#9484;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9488;</span><span>
</span><span id="line-41"></span><span class="hs-comment">-- &gt;    &#9474;&#9474;             &#9474;             &#9474;                           &#9474;             &#9474;</span><span>
</span><span id="line-42"></span><span class="hs-comment">-- &gt;    &#9474;&#9474;             &#9474;             &#9474;                           &#9474;             &#9474;</span><span>
</span><span id="line-43"></span><span class="hs-comment">-- &gt;    &#9474;&#9474;             &#9474;             &#9474;                           &#9474;             &#9474;</span><span>
</span><span id="line-44"></span><span class="hs-comment">-- &gt;    &#9474;&#9474;             &#9474;             &#9474;                           &#9474;             &#9474;</span><span>
</span><span id="line-45"></span><span class="hs-comment">-- &gt; 31 &#9508;&#9474;             &#9474;             &#9474;                           &#9474;             &#9474;</span><span>
</span><span id="line-46"></span><span class="hs-comment">-- &gt;    &#9474;&#9474;             &#9474;             &#9474;                           &#9474;             &#9474;</span><span>
</span><span id="line-47"></span><span class="hs-comment">-- &gt;    &#9474;&#9474;             &#9474;             &#9474;                           &#9474;             &#9474;</span><span>
</span><span id="line-48"></span><span class="hs-comment">-- &gt;    &#9474;&#9474;             &#9474;             &#9474;                           &#9474;             &#9474;</span><span>
</span><span id="line-49"></span><span class="hs-comment">-- &gt;    &#9474;&#9474;             &#9474;             &#9474;                           &#9474;             &#9474;</span><span>
</span><span id="line-50"></span><span class="hs-comment">-- &gt; 16 &#9508;&#9474;             &#9474;             &#9500;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9488;             &#9474;             &#9474;</span><span>
</span><span id="line-51"></span><span class="hs-comment">-- &gt;    &#9474;&#9474;             &#9474;             &#9474;             &#9474;             &#9474;             &#9474;</span><span>
</span><span id="line-52"></span><span class="hs-comment">-- &gt;    &#9474;&#9474;             &#9474;             &#9474;             &#9474;             &#9474;             &#9474;</span><span>
</span><span id="line-53"></span><span class="hs-comment">-- &gt;    &#9474;&#9474;             &#9474;             &#9474;             &#9474;             &#9474;             &#9474;</span><span>
</span><span id="line-54"></span><span class="hs-comment">-- &gt;    &#9474;&#9474;             &#9474;             &#9474;             &#9500;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9508;             &#9474;</span><span>
</span><span id="line-55"></span><span class="hs-comment">-- &gt;        Metallica    Iron Maiden     Slayer      Amon Amarth      Ghost</span><span>
</span><span id="line-56"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Plot.Text.Histogram</span><span>
</span><span id="line-57"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Plot.Text.Histogram.html#Histogram"><span class="hs-identifier">Histogram</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-58"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plot.Text.Histogram.html#plot"><span class="hs-identifier">plot</span></a></span><span>
</span><span id="line-59"></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-60"></span><span>
</span><span id="line-61"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Applicative</span></span><span>
</span><span id="line-62"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-operator">(&lt;|&gt;)</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-63"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.List</span></span><span>
</span><span id="line-64"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">nub</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-65"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Maybe</span></span><span>
</span><span id="line-66"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">fromJust</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">fromMaybe</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-67"></span><span>
</span><span id="line-68"></span><span class="hs-comment">-- | Model a distribution as an [Histogram](https://en.wikipedia.org/wiki/Histogram).</span><span>
</span><span id="line-69"></span><span class="hs-comment">-- This representation works for continuous non-overlapping distributions. Axes</span><span>
</span><span id="line-70"></span><span class="hs-comment">-- are labelled automatically based on the bins.</span><span>
</span><span id="line-71"></span><span class="hs-keyword">data</span><span> </span><span id="Histogram"><span class="annot"><a href="Plot.Text.Histogram.html#Histogram"><span class="hs-identifier hs-var">Histogram</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Histogram"><span class="annot"><a href="Plot.Text.Histogram.html#Histogram"><span class="hs-identifier hs-var">Histogram</span></a></span></span><span>
</span><span id="line-72"></span><span>    </span><span class="hs-special">{</span><span> </span><span id="%24sel%3Awidth%3AHistogram"><span class="annot"><span class="annottext">Histogram -&gt; Int
</span><a href="Plot.Text.Histogram.html#%24sel%3Awidth%3AHistogram"><span class="hs-identifier hs-var hs-var">width</span></a></span></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-73"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="%24sel%3Aheight%3AHistogram"><span class="annot"><span class="annottext">Histogram -&gt; Int
</span><a href="Plot.Text.Histogram.html#%24sel%3Aheight%3AHistogram"><span class="hs-identifier hs-var hs-var">height</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-74"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="%24sel%3Abins%3AHistogram"><span class="annot"><span class="annottext">Histogram -&gt; [(String, Int)]
</span><a href="Plot.Text.Histogram.html#%24sel%3Abins%3AHistogram"><span class="hs-identifier hs-var hs-var">bins</span></a></span></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-75"></span><span>    </span><span class="hs-special">}</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679041864"><span id="local-6989586621679041866"><span id="local-6989586621679041868"><span class="annot"><span class="annottext">Int -&gt; Histogram -&gt; ShowS
[Histogram] -&gt; ShowS
Histogram -&gt; String
(Int -&gt; Histogram -&gt; ShowS)
-&gt; (Histogram -&gt; String)
-&gt; ([Histogram] -&gt; ShowS)
-&gt; Show Histogram
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [Histogram] -&gt; ShowS
$cshowList :: [Histogram] -&gt; ShowS
show :: Histogram -&gt; String
$cshow :: Histogram -&gt; String
showsPrec :: Int -&gt; Histogram -&gt; ShowS
$cshowsPrec :: Int -&gt; Histogram -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679041855"><span id="local-6989586621679041857"><span id="local-6989586621679041859"><span id="local-6989586621679041861"><span class="annot"><span class="annottext">ReadPrec [Histogram]
ReadPrec Histogram
Int -&gt; ReadS Histogram
ReadS [Histogram]
(Int -&gt; ReadS Histogram)
-&gt; ReadS [Histogram]
-&gt; ReadPrec Histogram
-&gt; ReadPrec [Histogram]
-&gt; Read Histogram
forall a.
(Int -&gt; ReadS a)
-&gt; ReadS [a] -&gt; ReadPrec a -&gt; ReadPrec [a] -&gt; Read a
readListPrec :: ReadPrec [Histogram]
$creadListPrec :: ReadPrec [Histogram]
readPrec :: ReadPrec Histogram
$creadPrec :: ReadPrec Histogram
readList :: ReadS [Histogram]
$creadList :: ReadS [Histogram]
readsPrec :: Int -&gt; ReadS Histogram
$creadsPrec :: Int -&gt; ReadS Histogram
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Read</span></span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-76"></span><span>
</span><span id="line-77"></span><span class="hs-comment">-- | Convert an 'Histogram' to 'String'</span><span>
</span><span id="line-78"></span><span class="annot"><a href="Plot.Text.Histogram.html#plot"><span class="hs-identifier hs-type">plot</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Plot.Text.Histogram.html#Histogram"><span class="hs-identifier hs-type">Histogram</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-79"></span><span id="plot"><span class="annot"><span class="annottext">plot :: Histogram -&gt; String
</span><a href="Plot.Text.Histogram.html#plot"><span class="hs-identifier hs-var hs-var">plot</span></a></span></span><span> </span><span class="annot"><a href="Plot.Text.Histogram.html#Histogram"><span class="hs-identifier hs-type">Histogram</span></a></span><span class="hs-special">{</span><span id="local-6989586621679041853"><span class="annot"><span class="annottext">Int
width :: Int
$sel:width:Histogram :: Histogram -&gt; Int
</span><a href="#local-6989586621679041853"><span class="hs-identifier hs-var hs-var">width</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679041852"><span class="annot"><span class="annottext">Int
height :: Int
$sel:height:Histogram :: Histogram -&gt; Int
</span><a href="#local-6989586621679041852"><span class="hs-identifier hs-var hs-var">height</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679041851"><span class="annot"><span class="annottext">[(String, Int)]
bins :: [(String, Int)]
$sel:bins:Histogram :: Histogram -&gt; [(String, Int)]
</span><a href="#local-6989586621679041851"><span class="hs-identifier hs-var hs-var">bins</span></a></span></span><span class="hs-special">}</span><span>
</span><span id="line-80"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679041852"><span class="hs-identifier hs-var">height</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679041853"><span class="hs-identifier hs-var">width</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-81"></span><span>        </span><span class="annot"><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-82"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-83"></span><span>        </span><span class="annot"><span class="annottext">[String] -&gt; String
</span><span class="hs-identifier hs-var">unlines</span></span><span> </span><span class="annot"><span class="annottext">([String] -&gt; String) -&gt; [String] -&gt; String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Plot -&gt; [String]
</span><a href="Plot.Text.Histogram.html#%24sel%3AgetPlot%3APlot"><span class="hs-identifier hs-var hs-var">getPlot</span></a></span><span> </span><span class="annot"><span class="annottext">(Plot -&gt; [String]) -&gt; Plot -&gt; [String]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Plot] -&gt; Plot
forall a. Monoid a =&gt; [a] -&gt; a
</span><span class="hs-identifier hs-var">mconcat</span></span><span> </span><span class="annot"><span class="annottext">([Plot] -&gt; Plot) -&gt; [Plot] -&gt; Plot
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; [Axis] -&gt; Plot
</span><a href="Plot.Text.Histogram.html#axis"><span class="hs-identifier hs-var">axis</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679041846"><span class="hs-identifier hs-var">widthYAxis</span></a></span><span> </span><span class="annot"><span class="annottext">[Axis]
</span><a href="#local-6989586621679041845"><span class="hs-identifier hs-var">ys</span></a></span><span> </span><span class="annot"><span class="annottext">Plot -&gt; [Plot] -&gt; [Plot]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bar -&gt; Plot
</span><a href="Plot.Text.Histogram.html#bar"><span class="hs-identifier hs-var">bar</span></a></span><span> </span><span class="annot"><span class="annottext">(Bar -&gt; Plot) -&gt; ((String, Int) -&gt; Bar) -&gt; (String, Int) -&gt; Plot
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(String, Int) -&gt; Bar
forall i. Real i =&gt; (String, i) -&gt; Bar
</span><a href="#local-6989586621679041842"><span class="hs-identifier hs-var">mkBar</span></a></span><span> </span><span class="annot"><span class="annottext">((String, Int) -&gt; Plot) -&gt; [(String, Int)] -&gt; [Plot]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[(String, Int)]
</span><a href="#local-6989586621679041851"><span class="hs-identifier hs-var">bins</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-84"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-85"></span><span>    </span><span id="local-6989586621679041840"><span class="annot"><span class="annottext">highest :: Int
</span><a href="#local-6989586621679041840"><span class="hs-identifier hs-var hs-var">highest</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Int] -&gt; Int
forall (t :: * -&gt; *) a. (Foldable t, Ord a) =&gt; t a -&gt; a
</span><span class="hs-identifier hs-var">maximum</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(String, Int) -&gt; Int
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">((String, Int) -&gt; Int) -&gt; [(String, Int)] -&gt; [Int]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[(String, Int)]
</span><a href="#local-6989586621679041851"><span class="hs-identifier hs-var">bins</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-86"></span><span>    </span><span id="local-6989586621679041838"><span class="annot"><span class="annottext">nbLbls :: Int
</span><a href="#local-6989586621679041838"><span class="hs-identifier hs-var hs-var">nbLbls</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">min</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(String, Int)] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[(String, Int)]
</span><a href="#local-6989586621679041851"><span class="hs-identifier hs-var">bins</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679041852"><span class="hs-identifier hs-var">height</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`div`</span></span><span> </span><span class="annot"><span class="hs-number">3</span></span><span class="hs-special">)</span><span>
</span><span id="line-87"></span><span>
</span><span id="line-88"></span><span>    </span><span id="local-6989586621679041846"><span class="annot"><span class="annottext">widthYAxis :: Int
</span><a href="#local-6989586621679041846"><span class="hs-identifier hs-var hs-var">widthYAxis</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Int] -&gt; Int
forall (t :: * -&gt; *) a. (Foldable t, Ord a) =&gt; t a -&gt; a
</span><span class="hs-identifier hs-var">maximum</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="hs-number">3</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Int) -&gt; (String -&gt; Int) -&gt; String -&gt; Int
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Int) -&gt; [String] -&gt; [Int]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679041833"><span class="hs-identifier hs-var">lbls</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-89"></span><span>
</span><span id="line-90"></span><span>    </span><span id="local-6989586621679041842"><span class="annot"><span class="annottext">mkBar :: (String, i) -&gt; Bar
</span><a href="#local-6989586621679041842"><span class="hs-identifier hs-var hs-var">mkBar</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679041832"><span class="annot"><span class="annottext">label :: String
</span><a href="#local-6989586621679041832"><span class="hs-keyword hs-var">label</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679041831"><span class="annot"><span class="annottext">x :: i
</span><a href="#local-6989586621679041831"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bar :: Int -&gt; Int -&gt; String -&gt; Bar
</span><a href="Plot.Text.Histogram.html#Bar"><span class="hs-identifier hs-type hs-type">Bar</span></a></span><span>
</span><span id="line-91"></span><span>        </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">$sel:width:Bar :: Int
</span><a href="Plot.Text.Histogram.html#%24sel%3Awidth%3ABar"><span class="hs-identifier hs-var">width</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679041853"><span class="hs-identifier hs-var">width</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679041846"><span class="hs-identifier hs-var">widthYAxis</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`div`</span></span><span> </span><span class="annot"><span class="annottext">[(String, Int)] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[(String, Int)]
</span><a href="#local-6989586621679041851"><span class="hs-identifier hs-var">bins</span></a></span><span>
</span><span id="line-92"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">$sel:height:Bar :: Int
</span><a href="Plot.Text.Histogram.html#%24sel%3Aheight%3ABar"><span class="hs-identifier hs-var">height</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Int
forall a b. (RealFrac a, Integral b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">round</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Double
forall i. Real i =&gt; i -&gt; Double
</span><a href="Plot.Text.Histogram.html#double"><span class="hs-identifier hs-var">double</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679041852"><span class="hs-identifier hs-var">height</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">i -&gt; Double
forall i. Real i =&gt; i -&gt; Double
</span><a href="Plot.Text.Histogram.html#double"><span class="hs-identifier hs-var">double</span></a></span><span> </span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679041831"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Double
forall i. Real i =&gt; i -&gt; Double
</span><a href="Plot.Text.Histogram.html#double"><span class="hs-identifier hs-var">double</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679041840"><span class="hs-identifier hs-var">highest</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-93"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
$sel:label:Bar :: String
label :: String
</span><a href="Plot.Text.Histogram.html#%24sel%3Alabel%3ABar"><span class="hs-keyword hs-var hs-var">label</span></a></span><span>
</span><span id="line-94"></span><span>        </span><span class="hs-special">}</span><span>
</span><span id="line-95"></span><span>
</span><span id="line-96"></span><span>    </span><span id="local-6989586621679041833"><span class="annot"><span class="annottext">lbls :: [String]
</span><a href="#local-6989586621679041833"><span class="hs-identifier hs-var hs-var">lbls</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[String] -&gt; [String]
forall a. Eq a =&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">nub</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">(Integer -&gt; String) -&gt; Integer -&gt; String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Integer
forall a b. (RealFrac a, Integral b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">round</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Double
forall i. Real i =&gt; i -&gt; Double
</span><a href="Plot.Text.Histogram.html#double"><span class="hs-identifier hs-var">double</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679041840"><span class="hs-identifier hs-var">highest</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Double
forall i. Real i =&gt; i -&gt; Double
</span><a href="Plot.Text.Histogram.html#double"><span class="hs-identifier hs-var">double</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679041820"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Double
forall i. Real i =&gt; i -&gt; Double
</span><a href="Plot.Text.Histogram.html#double"><span class="hs-identifier hs-var">double</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679041838"><span class="hs-identifier hs-var">nbLbls</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-97"></span><span>               </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679041820"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679041820"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679041838"><span class="hs-identifier hs-var">nbLbls</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-98"></span><span>               </span><span class="hs-special">]</span><span>
</span><span id="line-99"></span><span>
</span><span id="line-100"></span><span>    </span><span id="local-6989586621679041845"><span class="annot"><span class="annottext">ys :: [Axis]
</span><a href="#local-6989586621679041845"><span class="hs-identifier hs-var hs-var">ys</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; String -&gt; Axis
</span><a href="Plot.Text.Histogram.html#Axis"><span class="hs-identifier hs-var">Axis</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; Int
forall a b. (RealFrac a, Integral b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">round</span></span><span> </span><span class="annot"><span class="annottext">(Double -&gt; Int) -&gt; Double -&gt; Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Double
forall i. Real i =&gt; i -&gt; Double
</span><a href="Plot.Text.Histogram.html#double"><span class="hs-identifier hs-var">double</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679041852"><span class="hs-identifier hs-var">height</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Double
forall i. Real i =&gt; i -&gt; Double
</span><a href="Plot.Text.Histogram.html#double"><span class="hs-identifier hs-var">double</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[String] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679041833"><span class="hs-identifier hs-var">lbls</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(String -&gt; Axis) -&gt; [String] -&gt; [Axis]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679041833"><span class="hs-identifier hs-var">lbls</span></a></span><span>
</span><span id="line-101"></span><span>
</span><span id="line-102"></span><span class="hs-comment">-- | Represent a labelled vertical bar.</span><span>
</span><span id="line-103"></span><span class="hs-keyword">data</span><span> </span><span id="Bar"><span class="annot"><a href="Plot.Text.Histogram.html#Bar"><span class="hs-identifier hs-var">Bar</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Bar"><span class="annot"><a href="Plot.Text.Histogram.html#Bar"><span class="hs-identifier hs-var">Bar</span></a></span></span><span>
</span><span id="line-104"></span><span>    </span><span class="hs-special">{</span><span> </span><span id="%24sel%3Awidth%3ABar"><span class="annot"><span class="annottext">Bar -&gt; Int
</span><a href="Plot.Text.Histogram.html#%24sel%3Awidth%3ABar"><span class="hs-identifier hs-var hs-var">width</span></a></span></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-105"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="%24sel%3Aheight%3ABar"><span class="annot"><span class="annottext">Bar -&gt; Int
</span><a href="Plot.Text.Histogram.html#%24sel%3Aheight%3ABar"><span class="hs-identifier hs-var hs-var">height</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-106"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="%24sel%3Alabel%3ABar"><span class="annot"><span class="annottext">Bar -&gt; String
</span><a href="Plot.Text.Histogram.html#%24sel%3Alabel%3ABar"><span class="hs-keyword hs-var hs-var">label</span></a></span></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-107"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-108"></span><span>
</span><span id="line-109"></span><span class="annot"><a href="Plot.Text.Histogram.html#bar"><span class="hs-identifier hs-type">bar</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Plot.Text.Histogram.html#Bar"><span class="hs-identifier hs-type">Bar</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plot.Text.Histogram.html#Plot"><span class="hs-identifier hs-type">Plot</span></a></span><span>
</span><span id="line-110"></span><span id="bar"><span class="annot"><span class="annottext">bar :: Bar -&gt; Plot
</span><a href="Plot.Text.Histogram.html#bar"><span class="hs-identifier hs-var hs-var">bar</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plot.Text.Histogram.html#Bar"><span class="hs-identifier hs-type">Bar</span></a></span><span> </span><span id="local-6989586621679041818"><span class="annot"><span class="annottext">w :: Int
</span><a href="#local-6989586621679041818"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621679041817"><span class="annot"><span class="annottext">h :: Int
</span><a href="#local-6989586621679041817"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span id="local-6989586621679041816"><span class="annot"><span class="annottext">l :: String
</span><a href="#local-6989586621679041816"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-111"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679041817"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-112"></span><span>        </span><span class="annot"><span class="annottext">[String] -&gt; Plot
</span><a href="Plot.Text.Histogram.html#Plot"><span class="hs-identifier hs-var">Plot</span></a></span><span> </span><span class="annot"><span class="annottext">([String] -&gt; Plot) -&gt; [String] -&gt; Plot
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Char -&gt; String
forall a. Int -&gt; a -&gt; [a]
</span><span class="hs-identifier hs-var">replicate</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679041818"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="hs-char">'&#9472;'</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; [String] -&gt; [String]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679041813"><span class="hs-identifier hs-var">lbl</span></a></span><span>
</span><span id="line-113"></span><span>
</span><span id="line-114"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-115"></span><span>        </span><span class="annot"><span class="annottext">[String] -&gt; Plot
</span><a href="Plot.Text.Histogram.html#Plot"><span class="hs-identifier hs-var">Plot</span></a></span><span> </span><span class="annot"><span class="annottext">([String] -&gt; Plot) -&gt; [String] -&gt; Plot
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Char -&gt; ShowS
forall e. Int -&gt; e -&gt; [e] -&gt; [e]
</span><a href="Plot.Text.Histogram.html#padMiddle"><span class="hs-identifier hs-var">padMiddle</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679041818"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="hs-char">'&#9472;'</span></span><span> </span><span class="annot"><span class="hs-string">&quot;&#9484;&#9488;&quot;</span></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-116"></span><span>            </span><span class="annot"><span class="annottext">[String] -&gt; [String] -&gt; [String]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Char -&gt; ShowS
forall e. Int -&gt; e -&gt; [e] -&gt; [e]
</span><a href="Plot.Text.Histogram.html#padMiddle"><span class="hs-identifier hs-var">padMiddle</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679041818"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="hs-char">' '</span></span><span> </span><span class="annot"><span class="hs-string">&quot;&#9474;&#9474;&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Int -&gt; [String]
forall e. e -&gt; Int -&gt; [e]
</span><a href="Plot.Text.Histogram.html#.%2A"><span class="hs-operator hs-var">.*</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679041817"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-117"></span><span>            </span><span class="annot"><span class="annottext">[String] -&gt; [String] -&gt; [String]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679041813"><span class="hs-identifier hs-var">lbl</span></a></span><span>
</span><span id="line-118"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-119"></span><span>    </span><span id="local-6989586621679041813"><span class="annot"><span class="annottext">lbl :: [String]
</span><a href="#local-6989586621679041813"><span class="hs-identifier hs-var hs-var">lbl</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Char -&gt; ShowS
forall e. Int -&gt; e -&gt; [e] -&gt; [e]
</span><a href="Plot.Text.Histogram.html#padBoth"><span class="hs-identifier hs-var">padBoth</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679041818"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="hs-char">' '</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679041816"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-120"></span><span>
</span><span id="line-121"></span><span class="hs-comment">-- | Represent one mark on the y-axis.</span><span>
</span><span id="line-122"></span><span class="hs-keyword">data</span><span> </span><span id="Axis"><span class="annot"><a href="Plot.Text.Histogram.html#Axis"><span class="hs-identifier hs-var">Axis</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Axis"><span class="annot"><a href="Plot.Text.Histogram.html#Axis"><span class="hs-identifier hs-var">Axis</span></a></span></span><span>
</span><span id="line-123"></span><span>    </span><span class="hs-special">{</span><span> </span><span id="%24sel%3Aheight%3AAxis"><span class="annot"><span class="annottext">Axis -&gt; Int
</span><a href="Plot.Text.Histogram.html#%24sel%3Aheight%3AAxis"><span class="hs-identifier hs-var hs-var">height</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-124"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="%24sel%3Alabel%3AAxis"><span class="annot"><span class="annottext">Axis -&gt; String
</span><a href="Plot.Text.Histogram.html#%24sel%3Alabel%3AAxis"><span class="hs-keyword hs-var hs-var">label</span></a></span></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-125"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-126"></span><span>
</span><span id="line-127"></span><span class="annot"><a href="Plot.Text.Histogram.html#axis"><span class="hs-identifier hs-type">axis</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Plot.Text.Histogram.html#Axis"><span class="hs-identifier hs-type">Axis</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plot.Text.Histogram.html#Plot"><span class="hs-identifier hs-type">Plot</span></a></span><span>
</span><span id="line-128"></span><span id="axis"><span class="annot"><span class="annottext">axis :: Int -&gt; [Axis] -&gt; Plot
</span><a href="Plot.Text.Histogram.html#axis"><span class="hs-identifier hs-var hs-var">axis</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[String] -&gt; Plot
</span><a href="Plot.Text.Histogram.html#Plot"><span class="hs-identifier hs-var">Plot</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-129"></span><span class="annot"><a href="Plot.Text.Histogram.html#axis"><span class="hs-identifier hs-var">axis</span></a></span><span> </span><span id="local-6989586621679041807"><span class="annot"><span class="annottext">w :: Int
</span><a href="#local-6989586621679041807"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621679041806"><span class="annot"><span class="annottext">es :: [Axis]
</span><a href="#local-6989586621679041806"><span class="hs-identifier hs-var">es</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[String] -&gt; Plot
</span><a href="Plot.Text.Histogram.html#Plot"><span class="hs-identifier hs-var">Plot</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Axis -&gt; [String]) -&gt; [Axis] -&gt; [String]
forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><span class="hs-identifier hs-var">concatMap</span></span><span> </span><span class="annot"><span class="annottext">Axis -&gt; [String]
</span><a href="#local-6989586621679041804"><span class="hs-identifier hs-var">each</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Axis] -&gt; [Axis]
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">reverse</span></span><span> </span><span class="annot"><span class="annottext">[Axis]
</span><a href="#local-6989586621679041806"><span class="hs-identifier hs-var">es</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[String] -&gt; [String] -&gt; [String]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Char -&gt; String
forall a. Int -&gt; a -&gt; [a]
</span><span class="hs-identifier hs-var">replicate</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679041807"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="hs-char">' '</span></span><span> </span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-130"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-131"></span><span>    </span><span class="annot"><a href="#local-6989586621679041804"><span class="hs-identifier hs-type">each</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Plot.Text.Histogram.html#Axis"><span class="hs-identifier hs-type">Axis</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">]</span><span>
</span><span id="line-132"></span><span>    </span><span id="local-6989586621679041804"><span class="annot"><span class="annottext">each :: Axis -&gt; [String]
</span><a href="#local-6989586621679041804"><span class="hs-identifier hs-var hs-var">each</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plot.Text.Histogram.html#Axis"><span class="hs-identifier hs-type">Axis</span></a></span><span> </span><span id="local-6989586621679041802"><span class="annot"><span class="annottext">h :: Int
</span><a href="#local-6989586621679041802"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span id="local-6989586621679041801"><span class="annot"><span class="annottext">l :: String
</span><a href="#local-6989586621679041801"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-133"></span><span>        </span><span class="annot"><span class="annottext">Int -&gt; Char -&gt; ShowS
forall e. Int -&gt; e -&gt; [e] -&gt; [e]
</span><a href="Plot.Text.Histogram.html#padLeft"><span class="hs-identifier hs-var">padLeft</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679041807"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="hs-char">' '</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679041801"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="hs-string">&quot; &#9508; &quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String -&gt; [String] -&gt; [String]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; String -&gt; [String]
forall a. Int -&gt; a -&gt; [a]
</span><span class="hs-identifier hs-var">replicate</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679041802"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Char -&gt; ShowS
forall e. Int -&gt; e -&gt; [e] -&gt; [e]
</span><a href="Plot.Text.Histogram.html#padLeft"><span class="hs-identifier hs-var">padLeft</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679041807"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="hs-char">' '</span></span><span> </span><span class="annot"><span class="hs-string">&quot;&#9474; &quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-134"></span><span>
</span><span id="line-135"></span><span class="hs-comment">--</span><span>
</span><span id="line-136"></span><span class="hs-comment">-- Plot</span><span>
</span><span id="line-137"></span><span class="hs-comment">--</span><span>
</span><span id="line-138"></span><span>
</span><span id="line-139"></span><span class="hs-comment">-- | A plot represents a partial plot on the console which is modeled as a 2D</span><span>
</span><span id="line-140"></span><span class="hs-comment">-- grid (a list of list of chars). Plots can be combined horizontally and merged</span><span>
</span><span id="line-141"></span><span class="hs-comment">-- into a bigger plot. Edges are smoothen into more appropriate charaters.</span><span>
</span><span id="line-142"></span><span class="hs-comment">--</span><span>
</span><span id="line-143"></span><span class="hs-comment">-- For any plots of length N &amp; M, the plot (N &lt;&gt; M) is of length (N + M - 1).</span><span>
</span><span id="line-144"></span><span class="hs-keyword">newtype</span><span> </span><span id="Plot"><span class="annot"><a href="Plot.Text.Histogram.html#Plot"><span class="hs-identifier hs-var">Plot</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Plot"><span class="annot"><a href="Plot.Text.Histogram.html#Plot"><span class="hs-identifier hs-var">Plot</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="%24sel%3AgetPlot%3APlot"><span class="annot"><span class="annottext">Plot -&gt; [String]
</span><a href="Plot.Text.Histogram.html#%24sel%3AgetPlot%3APlot"><span class="hs-identifier hs-var hs-var">getPlot</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">]</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-145"></span><span>
</span><span id="line-146"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679041795"><span id="local-6989586621679041797"><span class="annot"><span class="hs-identifier hs-type">Semigroup</span></span><span> </span><span class="annot"><a href="Plot.Text.Histogram.html#Plot"><span class="hs-identifier hs-type">Plot</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-147"></span><span>    </span><span class="annot"><a href="Plot.Text.Histogram.html#Plot"><span class="hs-identifier hs-type">Plot</span></a></span><span> </span><span id="local-6989586621679041793"><span class="annot"><span class="annottext">xs :: [String]
</span><a href="#local-6989586621679041793"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span id="local-6989586621679041792"><span class="annot"><span class="annottext">&lt;&gt; :: Plot -&gt; Plot -&gt; Plot
</span><span class="hs-operator hs-var hs-var hs-var hs-var">&lt;&gt;</span></span></span><span> </span><span class="annot"><a href="Plot.Text.Histogram.html#Plot"><span class="hs-identifier hs-type">Plot</span></a></span><span> </span><span id="local-6989586621679041791"><span class="annot"><span class="annottext">ys :: [String]
</span><a href="#local-6989586621679041791"><span class="hs-identifier hs-var">ys</span></a></span></span><span>
</span><span id="line-148"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">[String] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679041793"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">[String] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679041791"><span class="hs-identifier hs-var">ys</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-149"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679041789"><span class="annot"><span class="annottext">ys' :: [String]
</span><a href="#local-6989586621679041789"><span class="hs-identifier hs-var hs-var">ys'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; [String] -&gt; [String]
</span><a href="Plot.Text.Histogram.html#fill"><span class="hs-identifier hs-var">fill</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679041787"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679041786"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679041791"><span class="hs-identifier hs-var">ys</span></a></span><span> </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">[String] -&gt; Plot
</span><a href="Plot.Text.Histogram.html#Plot"><span class="hs-identifier hs-var">Plot</span></a></span><span> </span><span class="annot"><span class="annottext">([String] -&gt; Plot) -&gt; [String] -&gt; Plot
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; ShowS) -&gt; [String] -&gt; [String] -&gt; [String]
forall a b c. (a -&gt; b -&gt; c) -&gt; [a] -&gt; [b] -&gt; [c]
</span><span class="hs-identifier hs-var">zipWith</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
</span><a href="#local-6989586621679041784"><span class="hs-identifier hs-var">merge</span></a></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679041793"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679041789"><span class="hs-identifier hs-var">ys'</span></a></span><span>
</span><span id="line-150"></span><span>
</span><span id="line-151"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-152"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679041783"><span class="annot"><span class="annottext">xs' :: [String]
</span><a href="#local-6989586621679041783"><span class="hs-identifier hs-var hs-var">xs'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; [String] -&gt; [String]
</span><a href="Plot.Text.Histogram.html#fill"><span class="hs-identifier hs-var">fill</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679041786"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679041787"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679041793"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">[String] -&gt; Plot
</span><a href="Plot.Text.Histogram.html#Plot"><span class="hs-identifier hs-var">Plot</span></a></span><span> </span><span class="annot"><span class="annottext">([String] -&gt; Plot) -&gt; [String] -&gt; Plot
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; ShowS) -&gt; [String] -&gt; [String] -&gt; [String]
forall a b c. (a -&gt; b -&gt; c) -&gt; [a] -&gt; [b] -&gt; [c]
</span><span class="hs-identifier hs-var">zipWith</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
</span><a href="#local-6989586621679041784"><span class="hs-identifier hs-var">merge</span></a></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679041783"><span class="hs-identifier hs-var">xs'</span></a></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679041791"><span class="hs-identifier hs-var">ys</span></a></span><span>
</span><span id="line-153"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-154"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621679041787"><span class="annot"><span class="annottext">x :: Int
</span><a href="#local-6989586621679041787"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679041786"><span class="annot"><span class="annottext">y :: Int
</span><a href="#local-6989586621679041786"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[String] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679041793"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[String] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679041791"><span class="hs-identifier hs-var">ys</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-155"></span><span>
</span><span id="line-156"></span><span>        </span><span id="local-6989586621679041784"><span class="annot"><span class="annottext">merge :: String -&gt; ShowS
</span><a href="#local-6989586621679041784"><span class="hs-identifier hs-var hs-var">merge</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span id="local-6989586621679041782"><span class="annot"><span class="annottext">ys :: String
</span><a href="#local-6989586621679041782"><span class="hs-identifier hs-var">ys</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679041782"><span class="hs-identifier hs-var">ys</span></a></span><span>
</span><span id="line-157"></span><span>        </span><span class="annot"><a href="#local-6989586621679041784"><span class="hs-identifier hs-var">merge</span></a></span><span> </span><span id="local-6989586621679041781"><span class="annot"><span class="annottext">xs :: String
</span><a href="#local-6989586621679041781"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679041781"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-158"></span><span>        </span><span class="annot"><a href="#local-6989586621679041784"><span class="hs-identifier hs-var">merge</span></a></span><span> </span><span id="local-6989586621679041780"><span class="annot"><span class="annottext">xs :: String
</span><a href="#local-6989586621679041780"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span id="local-6989586621679041779"><span class="annot"><span class="annottext">ys :: String
</span><a href="#local-6989586621679041779"><span class="hs-identifier hs-var">ys</span></a></span></span><span>
</span><span id="line-159"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">String -&gt; Bool
</span><a href="#local-6989586621679041778"><span class="hs-identifier hs-var">match</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;&#9474;&#9474;&quot;</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ShowS
</span><a href="#local-6989586621679041777"><span class="hs-identifier hs-var">into</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;&#9474;&quot;</span></span><span>
</span><span id="line-160"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">String -&gt; Bool
</span><a href="#local-6989586621679041778"><span class="hs-identifier hs-var">match</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;&#9474;&#9484;&quot;</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ShowS
</span><a href="#local-6989586621679041777"><span class="hs-identifier hs-var">into</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;&#9500;&quot;</span></span><span>
</span><span id="line-161"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">String -&gt; Bool
</span><a href="#local-6989586621679041778"><span class="hs-identifier hs-var">match</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;&#9474; &quot;</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ShowS
</span><a href="#local-6989586621679041777"><span class="hs-identifier hs-var">into</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;&#9474;&quot;</span></span><span>
</span><span id="line-162"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">String -&gt; Bool
</span><a href="#local-6989586621679041778"><span class="hs-identifier hs-var">match</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;&#9488;&#9474;&quot;</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ShowS
</span><a href="#local-6989586621679041777"><span class="hs-identifier hs-var">into</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;&#9508;&quot;</span></span><span>
</span><span id="line-163"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">String -&gt; Bool
</span><a href="#local-6989586621679041778"><span class="hs-identifier hs-var">match</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;&#9488;&#9484;&quot;</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ShowS
</span><a href="#local-6989586621679041777"><span class="hs-identifier hs-var">into</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;&#9516;&quot;</span></span><span>
</span><span id="line-164"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">String -&gt; Bool
</span><a href="#local-6989586621679041778"><span class="hs-identifier hs-var">match</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;&#9488; &quot;</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ShowS
</span><a href="#local-6989586621679041777"><span class="hs-identifier hs-var">into</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;&#9488;&quot;</span></span><span>
</span><span id="line-165"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">String -&gt; Bool
</span><a href="#local-6989586621679041778"><span class="hs-identifier hs-var">match</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot; &#9474;&quot;</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ShowS
</span><a href="#local-6989586621679041777"><span class="hs-identifier hs-var">into</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;&#9474;&quot;</span></span><span>
</span><span id="line-166"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">String -&gt; Bool
</span><a href="#local-6989586621679041778"><span class="hs-identifier hs-var">match</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot; &#9484;&quot;</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ShowS
</span><a href="#local-6989586621679041777"><span class="hs-identifier hs-var">into</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;&#9484;&quot;</span></span><span>
</span><span id="line-167"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">String -&gt; Bool
</span><a href="#local-6989586621679041778"><span class="hs-identifier hs-var">match</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;&#9472;&#9474;&quot;</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ShowS
</span><a href="#local-6989586621679041777"><span class="hs-identifier hs-var">into</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;&#9496;&quot;</span></span><span>
</span><span id="line-168"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">String -&gt; Bool
</span><a href="#local-6989586621679041778"><span class="hs-identifier hs-var">match</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;&#9474;&#9472;&quot;</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ShowS
</span><a href="#local-6989586621679041777"><span class="hs-identifier hs-var">into</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;&#9492;&quot;</span></span><span>
</span><span id="line-169"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">String -&gt; Bool
</span><a href="#local-6989586621679041778"><span class="hs-identifier hs-var">match</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;&#9472;&#9472;&quot;</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ShowS
</span><a href="#local-6989586621679041777"><span class="hs-identifier hs-var">into</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;&#9472;&quot;</span></span><span>
</span><span id="line-170"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">String -&gt; Bool
</span><a href="#local-6989586621679041778"><span class="hs-identifier hs-var">match</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;&#9516;&#9472;&quot;</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ShowS
</span><a href="#local-6989586621679041777"><span class="hs-identifier hs-var">into</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;&#9516;&quot;</span></span><span>
</span><span id="line-171"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">String -&gt; Bool
</span><a href="#local-6989586621679041778"><span class="hs-identifier hs-var">match</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;&#9488;&#9472;&quot;</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ShowS
</span><a href="#local-6989586621679041777"><span class="hs-identifier hs-var">into</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;&#9472;&quot;</span></span><span>
</span><span id="line-172"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">String -&gt; Bool
</span><a href="#local-6989586621679041778"><span class="hs-identifier hs-var">match</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;&#9472;&#9484;&quot;</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ShowS
</span><a href="#local-6989586621679041777"><span class="hs-identifier hs-var">into</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;&#9472;&quot;</span></span><span>
</span><span id="line-173"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ShowS
</span><a href="#local-6989586621679041777"><span class="hs-identifier hs-var">into</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot; &quot;</span></span><span>
</span><span id="line-174"></span><span>          </span><span class="hs-keyword">where</span><span>
</span><span id="line-175"></span><span>            </span><span id="local-6989586621679041778"><span class="annot"><span class="annottext">match :: String -&gt; Bool
</span><a href="#local-6989586621679041778"><span class="hs-identifier hs-var hs-var">match</span></a></span></span><span> </span><span class="hs-special">[</span><span id="local-6989586621679041776"><span class="annot"><span class="annottext">a :: Char
</span><a href="#local-6989586621679041776"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679041775"><span class="annot"><span class="annottext">b :: Char
</span><a href="#local-6989586621679041775"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Char
forall a. [a] -&gt; a
</span><span class="hs-identifier hs-var">last</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679041780"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Char -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679041776"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Char
forall a. [a] -&gt; a
</span><span class="hs-identifier hs-var">head</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679041779"><span class="hs-identifier hs-var">ys</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Char -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679041775"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-176"></span><span>            </span><span id="local-6989586621679041777"><span class="annot"><span class="annottext">into :: ShowS
</span><a href="#local-6989586621679041777"><span class="hs-identifier hs-var hs-var">into</span></a></span></span><span> </span><span id="local-6989586621679041771"><span class="annot"><span class="annottext">s :: String
</span><a href="#local-6989586621679041771"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ShowS
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">init</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679041780"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679041771"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">ShowS
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">tail</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679041779"><span class="hs-identifier hs-var">ys</span></a></span><span>
</span><span id="line-177"></span><span>
</span><span id="line-178"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679041763"><span id="local-6989586621679041765"><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="annot"><a href="Plot.Text.Histogram.html#Plot"><span class="hs-identifier hs-type">Plot</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-179"></span><span>    </span><span id="local-6989586621679041761"><span class="annot"><span class="annottext">mempty :: Plot
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">mempty</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[String] -&gt; Plot
</span><a href="Plot.Text.Histogram.html#Plot"><span class="hs-identifier hs-var">Plot</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-180"></span><span>
</span><span id="line-181"></span><span class="hs-comment">--</span><span>
</span><span id="line-182"></span><span class="hs-comment">-- Helpers</span><span>
</span><span id="line-183"></span><span class="hs-comment">--</span><span>
</span><span id="line-184"></span><span>
</span><span id="line-185"></span><span class="hs-keyword">infixl</span><span> </span><span class="hs-number">5</span><span> </span><span class="annot"><a href="Plot.Text.Histogram.html#.%2A"><span class="hs-operator hs-type">.*</span></a></span><span>
</span><span id="line-186"></span><span>
</span><span id="line-187"></span><span id="local-6989586621679041902"><span class="annot"><a href="Plot.Text.Histogram.html#.%2A"><span class="hs-operator hs-type">(.*)</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679041902"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679041902"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-188"></span><span id=".%2A"><span class="annot"><span class="annottext">.* :: e -&gt; Int -&gt; [e]
</span><a href="Plot.Text.Histogram.html#.%2A"><span class="hs-operator hs-var hs-var">(.*)</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Int -&gt; e -&gt; [e]) -&gt; e -&gt; Int -&gt; [e]
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; e -&gt; [e]
forall a. Int -&gt; a -&gt; [a]
</span><span class="hs-identifier hs-var">replicate</span></span><span>
</span><span id="line-189"></span><span>
</span><span id="line-190"></span><span id="local-6989586621679041908"><span class="annot"><a href="Plot.Text.Histogram.html#double"><span class="hs-identifier hs-type">double</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Real</span></span><span> </span><span class="annot"><a href="#local-6989586621679041908"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679041908"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span></span><span>
</span><span id="line-191"></span><span id="double"><span class="annot"><span class="annottext">double :: i -&gt; Double
</span><a href="Plot.Text.Histogram.html#double"><span class="hs-identifier hs-var hs-var">double</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Double
forall a. Fractional a =&gt; Rational -&gt; a
</span><span class="hs-identifier hs-var">fromRational</span></span><span> </span><span class="annot"><span class="annottext">(Rational -&gt; Double) -&gt; (i -&gt; Rational) -&gt; i -&gt; Double
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">i -&gt; Rational
forall a. Real a =&gt; a -&gt; Rational
</span><span class="hs-identifier hs-var">toRational</span></span><span>
</span><span id="line-192"></span><span>
</span><span id="line-193"></span><span id="local-6989586621679041759"><span class="annot"><a href="Plot.Text.Histogram.html#padRight"><span class="hs-identifier hs-type">padRight</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679041759"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679041759"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679041759"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-194"></span><span id="padRight"><span class="annot"><span class="annottext">padRight :: Int -&gt; e -&gt; [e] -&gt; [e]
</span><a href="Plot.Text.Histogram.html#padRight"><span class="hs-identifier hs-var hs-var">padRight</span></a></span></span><span> </span><span id="local-6989586621679041757"><span class="annot"><span class="annottext">n :: Int
</span><a href="#local-6989586621679041757"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679041756"><span class="annot"><span class="annottext">e :: e
</span><a href="#local-6989586621679041756"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span id="local-6989586621679041755"><span class="annot"><span class="annottext">es :: [e]
</span><a href="#local-6989586621679041755"><span class="hs-identifier hs-var">es</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-195"></span><span>    </span><span class="annot"><span class="annottext">[e]
</span><a href="#local-6989586621679041755"><span class="hs-identifier hs-var">es</span></a></span><span> </span><span class="annot"><span class="annottext">[e] -&gt; [e] -&gt; [e]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; e -&gt; [e]
forall a. Int -&gt; a -&gt; [a]
</span><span class="hs-identifier hs-var">replicate</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679041757"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">[e] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[e]
</span><a href="#local-6989586621679041755"><span class="hs-identifier hs-var">es</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">e
</span><a href="#local-6989586621679041756"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-196"></span><span>
</span><span id="line-197"></span><span id="local-6989586621679041754"><span class="annot"><a href="Plot.Text.Histogram.html#padLeft"><span class="hs-identifier hs-type">padLeft</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679041754"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679041754"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679041754"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-198"></span><span id="padLeft"><span class="annot"><span class="annottext">padLeft :: Int -&gt; e -&gt; [e] -&gt; [e]
</span><a href="Plot.Text.Histogram.html#padLeft"><span class="hs-identifier hs-var hs-var">padLeft</span></a></span></span><span> </span><span id="local-6989586621679041753"><span class="annot"><span class="annottext">n :: Int
</span><a href="#local-6989586621679041753"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679041752"><span class="annot"><span class="annottext">e :: e
</span><a href="#local-6989586621679041752"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span id="local-6989586621679041751"><span class="annot"><span class="annottext">es :: [e]
</span><a href="#local-6989586621679041751"><span class="hs-identifier hs-var">es</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-199"></span><span>    </span><span class="annot"><span class="annottext">Int -&gt; e -&gt; [e]
forall a. Int -&gt; a -&gt; [a]
</span><span class="hs-identifier hs-var">replicate</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679041753"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">[e] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[e]
</span><a href="#local-6989586621679041751"><span class="hs-identifier hs-var">es</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">e
</span><a href="#local-6989586621679041752"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">[e] -&gt; [e] -&gt; [e]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[e]
</span><a href="#local-6989586621679041751"><span class="hs-identifier hs-var">es</span></a></span><span>
</span><span id="line-200"></span><span>
</span><span id="line-201"></span><span id="local-6989586621679041750"><span class="annot"><a href="Plot.Text.Histogram.html#padBoth"><span class="hs-identifier hs-type">padBoth</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679041750"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679041750"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679041750"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-202"></span><span id="padBoth"><span class="annot"><span class="annottext">padBoth :: Int -&gt; e -&gt; [e] -&gt; [e]
</span><a href="Plot.Text.Histogram.html#padBoth"><span class="hs-identifier hs-var hs-var">padBoth</span></a></span></span><span> </span><span id="local-6989586621679041749"><span class="annot"><span class="annottext">n :: Int
</span><a href="#local-6989586621679041749"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679041748"><span class="annot"><span class="annottext">e :: e
</span><a href="#local-6989586621679041748"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span id="local-6989586621679041747"><span class="annot"><span class="annottext">es :: [e]
</span><a href="#local-6989586621679041747"><span class="hs-identifier hs-var">es</span></a></span></span><span>
</span><span id="line-203"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679041746"><span class="hs-identifier hs-var">len</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679041749"><span class="hs-identifier hs-var">n</span></a></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[e]
</span><a href="#local-6989586621679041747"><span class="hs-identifier hs-var">es</span></a></span><span>
</span><span id="line-204"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679041746"><span class="hs-identifier hs-var">len</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`mod`</span></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; e -&gt; [e] -&gt; [e]
forall e. Int -&gt; e -&gt; [e] -&gt; [e]
</span><a href="Plot.Text.Histogram.html#padBoth"><span class="hs-identifier hs-var">padBoth</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679041749"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">e
</span><a href="#local-6989586621679041748"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">([e] -&gt; [e]) -&gt; [e] -&gt; [e]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; e -&gt; [e] -&gt; [e]
forall e. Int -&gt; e -&gt; [e] -&gt; [e]
</span><a href="Plot.Text.Histogram.html#padRight"><span class="hs-identifier hs-var">padRight</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679041746"><span class="hs-identifier hs-var">len</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">e
</span><a href="#local-6989586621679041748"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">[e]
</span><a href="#local-6989586621679041747"><span class="hs-identifier hs-var">es</span></a></span><span>
</span><span id="line-205"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; e -&gt; [e] -&gt; [e]
forall e. Int -&gt; e -&gt; [e] -&gt; [e]
</span><a href="Plot.Text.Histogram.html#padBoth"><span class="hs-identifier hs-var">padBoth</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679041749"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">e
</span><a href="#local-6989586621679041748"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">([e] -&gt; [e]) -&gt; [e] -&gt; [e]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; e -&gt; [e] -&gt; [e]
forall e. Int -&gt; e -&gt; [e] -&gt; [e]
</span><a href="Plot.Text.Histogram.html#padLeft"><span class="hs-identifier hs-var">padLeft</span></a></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679041746"><span class="hs-identifier hs-var">len</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">e
</span><a href="#local-6989586621679041748"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">[e]
</span><a href="#local-6989586621679041747"><span class="hs-identifier hs-var">es</span></a></span><span>
</span><span id="line-206"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-207"></span><span>    </span><span id="local-6989586621679041746"><span class="annot"><span class="annottext">len :: Int
</span><a href="#local-6989586621679041746"><span class="hs-identifier hs-var hs-var">len</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[e] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[e]
</span><a href="#local-6989586621679041747"><span class="hs-identifier hs-var">es</span></a></span><span>
</span><span id="line-208"></span><span>
</span><span id="line-209"></span><span id="local-6989586621679041904"><span class="annot"><a href="Plot.Text.Histogram.html#padMiddle"><span class="hs-identifier hs-type">padMiddle</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679041904"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679041904"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679041904"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-210"></span><span id="padMiddle"><span class="annot"><span class="annottext">padMiddle :: Int -&gt; e -&gt; [e] -&gt; [e]
</span><a href="Plot.Text.Histogram.html#padMiddle"><span class="hs-identifier hs-var hs-var">padMiddle</span></a></span></span><span> </span><span id="local-6989586621679041744"><span class="annot"><span class="annottext">n :: Int
</span><a href="#local-6989586621679041744"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679041743"><span class="annot"><span class="annottext">e :: e
</span><a href="#local-6989586621679041743"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span id="local-6989586621679041742"><span class="annot"><span class="annottext">es :: [e]
</span><a href="#local-6989586621679041742"><span class="hs-identifier hs-var">es</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-211"></span><span>    </span><span class="annot"><span class="annottext">Int -&gt; [e] -&gt; [e]
forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">take</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679041740"><span class="hs-identifier hs-var">half</span></a></span><span> </span><span class="annot"><span class="annottext">[e]
</span><a href="#local-6989586621679041742"><span class="hs-identifier hs-var">es</span></a></span><span> </span><span class="annot"><span class="annottext">[e] -&gt; [e] -&gt; [e]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; e -&gt; [e]
forall a. Int -&gt; a -&gt; [a]
</span><span class="hs-identifier hs-var">replicate</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679041739"><span class="hs-identifier hs-var">&#948;</span></a></span><span> </span><span class="annot"><span class="annottext">e
</span><a href="#local-6989586621679041743"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">[e] -&gt; [e] -&gt; [e]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; [e] -&gt; [e]
forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">drop</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679041740"><span class="hs-identifier hs-var">half</span></a></span><span> </span><span class="annot"><span class="annottext">[e]
</span><a href="#local-6989586621679041742"><span class="hs-identifier hs-var">es</span></a></span><span>
</span><span id="line-212"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-213"></span><span>    </span><span id="local-6989586621679041739"><span class="annot"><span class="annottext">&#948; :: Int
</span><a href="#local-6989586621679041739"><span class="hs-identifier hs-var hs-var">&#948;</span></a></span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679041744"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">[e] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[e]
</span><a href="#local-6989586621679041742"><span class="hs-identifier hs-var">es</span></a></span><span>
</span><span id="line-214"></span><span>    </span><span id="local-6989586621679041740"><span class="annot"><span class="annottext">half :: Int
</span><a href="#local-6989586621679041740"><span class="hs-identifier hs-var hs-var">half</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[e] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[e]
</span><a href="#local-6989586621679041742"><span class="hs-identifier hs-var">es</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`div`</span></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span>
</span><span id="line-215"></span><span>
</span><span id="line-216"></span><span class="annot"><a href="Plot.Text.Histogram.html#fill"><span class="hs-identifier hs-type">fill</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">]</span><span>
</span><span id="line-217"></span><span id="fill"><span class="annot"><span class="annottext">fill :: Int -&gt; [String] -&gt; [String]
</span><a href="Plot.Text.Histogram.html#fill"><span class="hs-identifier hs-var hs-var">fill</span></a></span></span><span> </span><span id="local-6989586621679041737"><span class="annot"><span class="annottext">n :: Int
</span><a href="#local-6989586621679041737"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; String -&gt; [String]
forall a. Int -&gt; a -&gt; [a]
</span><span class="hs-identifier hs-var">replicate</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679041737"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">String
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-218"></span><span class="annot"><a href="Plot.Text.Histogram.html#fill"><span class="hs-identifier hs-var">fill</span></a></span><span> </span><span id="local-6989586621679041736"><span class="annot"><span class="annottext">n :: Int
</span><a href="#local-6989586621679041736"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679041735"><span class="annot"><span class="annottext">h :: String
</span><a href="#local-6989586621679041735"><span class="hs-identifier hs-var">h</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679041734"><span class="annot"><span class="annottext">q :: [String]
</span><a href="#local-6989586621679041734"><span class="hs-identifier hs-var">q</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; String -&gt; [String]
forall a. Int -&gt; a -&gt; [a]
</span><span class="hs-identifier hs-var">replicate</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679041736"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Char -&gt; String
forall a. Int -&gt; a -&gt; [a]
</span><span class="hs-identifier hs-var">replicate</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679041735"><span class="hs-identifier hs-var">h</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-char">' '</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[String] -&gt; [String] -&gt; [String]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679041735"><span class="hs-identifier hs-var">h</span></a></span><span class="annot"><span class="annottext">String -&gt; [String] -&gt; [String]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679041734"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-219"></span></pre></body></html>